!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["form-table"]=t():e["form-table"]=t()}(this,(function(){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=5)}([function(e,t,a){var n=a(2);"string"==typeof n&&(n=[[e.i,n,""]]);var r={insert:"head",singleton:!1};a(4)(n,r);n.locals&&(e.exports=n.locals)},function(e,t,a){"use strict";var n=a(0);a.n(n).a},function(e,t,a){(e.exports=a(3)(!1)).push([e.i,"\n.header-form[data-v-f2466236] {\n  margin-bottom: 10px;\n  display: flex;\n  align-content: center;\n  flex-wrap: wrap;\n}\n.header-form-item[data-v-f2466236] {\n  margin-right: 12px;\n  margin-bottom: 10px;\n}\n.header-form-label[data-v-f2466236] {\n    font-size: 14px;\n    color: #909399;\n}\n.pagination-center[data-v-f2466236] {\n  margin-top: 30px;\n  text-align: center;\n}\n.header-title[data-v-f2466236] {\n  display: flex;\n  margin-bottom: 20px;\n  font-size: 18px;\n  color: #777;\n}\n.header-title-item[data-v-f2466236] {\n    margin-right: 15px;\n    display: flex;\n}\n",""])},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var r=(o=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),i=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot).concat(e," */")}));return[a].concat(i).concat([r]).join("\n")}var o,s,l;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(a,"}"):a})).join("")},t.i=function(e,a){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var i=this[r][0];null!=i&&(n[i]=!0)}for(var o=0;o<e.length;o++){var s=e[o];null!=s[0]&&n[s[0]]||(a&&!s[2]?s[2]=a:a&&(s[2]="(".concat(s[2],") and (").concat(a,")")),t.push(s))}},t}},function(e,t,a){"use strict";var n,r={},i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}();function s(e,t){for(var a=[],n={},r=0;r<e.length;r++){var i=e[r],o=t.base?i[0]+t.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};n[o]?n[o].parts.push(s):a.push(n[o]={id:o,parts:[s]})}return a}function l(e,t){for(var a=0;a<e.length;a++){var n=e[a],i=r[n.id],o=0;if(i){for(i.refs++;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(v(n.parts[o],t))}else{for(var s=[];o<n.parts.length;o++)s.push(v(n.parts[o],t));r[n.id]={id:n.id,refs:1,parts:s}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var n=a.nc;n&&(e.attributes.nonce=n)}if(Object.keys(e.attributes).forEach((function(a){t.setAttribute(a,e.attributes[a])})),"function"==typeof e.insert)e.insert(t);else{var r=o(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,a,n){var r=a?"":n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var i=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(i,o[t]):e.appendChild(i)}}function f(e,t,a){var n=a.css,r=a.media,i=a.sourceMap;if(r&&e.setAttribute("media",r),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,m=0;function v(e,t){var a,n,r;if(t.singleton){var i=m++;a=h||(h=c(t)),n=p.bind(null,a,i,!1),r=p.bind(null,a,i,!0)}else a=c(t),n=f.bind(null,a,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i());var a=s(e,t);return l(a,t),function(e){for(var n=[],i=0;i<a.length;i++){var o=a[i],c=r[o.id];c&&(c.refs--,n.push(c))}e&&l(s(e,t),t);for(var d=0;d<n.length;d++){var u=n[d];if(0===u.refs){for(var p=0;p<u.parts.length;p++)u.parts[p]();delete r[u.id]}}}}},function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.titles.length?a("div",{staticClass:"header-title"},e._l(e.titles,(function(t,n){return a("div",{key:n,staticClass:"header-title-item"},[a("span",{staticClass:"header-title-label"},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticClass:"header-title-content"},[e._v(e._s(e.result[t.key]))])])})),0):e._e(),e._v(" "),e.formOptions?a("div",{staticClass:"header-form"},[e._t("formItem"),e._v(" "),e._l(e.formOptions.forms,(function(t,n){return a("div",{key:n,staticClass:"header-form-item"},[a("span",{staticClass:"header-form-label"},[e._v(e._s(t.label))]),e._v(" "),"input"===t.itemType||void 0===t.itemType?a("el-input",{style:{width:(t.itemWidth||120)+"px"},attrs:{size:t.size?t.size:e.size,placeholder:t.placeholder},model:{value:e.params[t.modelValue],callback:function(a){e.$set(e.params,t.modelValue,a)},expression:"params[form.modelValue]"}}):"select"===t.itemType?a("el-select",{style:{width:(t.itemWidth||120)+"px"},attrs:{size:t.size?t.size:e.size,disabled:t.disabled,placeholder:t.placeholder},model:{value:e.params[t.modelValue],callback:function(a){e.$set(e.params,t.modelValue,a)},expression:"params[form.modelValue]"}},e._l(t.options,(function(e,n){return a("el-option",{key:n+"_local",attrs:{value:"object"==typeof e?e[t.valueKey||"value"]:e,label:"object"==typeof e?e[t.labelKey||"label"]:e}})})),1):"date"===t.itemType?a("el-date-picker",{style:{width:(t.itemWidth||240)+"px"},attrs:{format:t.format||"yyyy.MM.dd","value-format":t.format||"yyyy.MM.dd",type:"date",placeholder:t.placeholder,size:t.size?t.size:e.size,disabled:t.disabled,readonly:t.readonly,editable:t.editable,"picker-options":t.pickerOptions||{}},model:{value:e.params[t.modelValue],callback:function(a){e.$set(e.params,t.modelValue,a)},expression:"params[form.modelValue]"}}):"daterange"===t.itemType?a("el-date-picker",{style:{width:(t.itemWidth||240)+"px"},attrs:{format:t.format||"yyyy.MM.dd","value-format":t.format||"yyyy.MM.dd",size:t.size?t.size:e.size,type:"daterange",disabled:t.disabled,readonly:t.readonly,editable:t.editable,"range-separator":t.rangeSeparator,"start-placeholder":t.startPlaceholder,"end-placeholder":t.endPlaceholder,"picker-options":t.pickerOptions||{}},on:{change:function(a){return e.changeDate(a,t)}},model:{value:e.params[t.modelValue],callback:function(a){e.$set(e.params,t.modelValue,a)},expression:"params[form.modelValue]"}}):e._e()],1)})),e._v(" "),e._t("formItemEnd"),e._v(" "),e.formOptions.closeSearch?e._e():a("div",{staticClass:"header-form-item"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.initData}},[e._v("\n        搜索\n      ")])],1),e._v(" "),e.formOptions.closeDown?e._e():a("div",{staticClass:"header-form-item"},[a("el-button",{staticClass:"green",attrs:{size:"small",type:"primary",icon:"el-icon-download"},on:{click:e.exportExcel}},[e._v("\n        导出EXCEL\n      ")])],1),e._v(" "),e._t("formItemButton")],2):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",fit:"","highlight-current-row":""}},[e._l(e.columns,(function(t,n){return["index"===t.type?a("el-table-column",e._b({key:n,attrs:{index:e.indexMethod,align:"center"}},"el-table-column",t,!1)):t.type?a("el-table-column",e._b({key:n,attrs:{align:"center"}},"el-table-column",t,!1)):a("el-table-column",{key:n,attrs:{prop:t.prop,label:t.label,sortable:t.sortable,width:t.minWidth?"-":t.width||e.tableColumnWidth,minWidth:t.minWidth||t.width||e.tableColumnWidth,align:"center"},scopedSlots:e._u([{key:"default",fn:function(n){return[t.render?a("span",[e._v("\n            "+e._s(t.render(n.row))+"\n          ")]):a("span",[e._v("\n            "+e._s(e._f("handleColumn")(n.row,t.prop))+"\n          ")])]}}],null,!0)})]})),e._v(" "),e._t("append")],2),e._v(" "),a("div",{staticClass:"pagination-center"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)};n._withStripped=!0;var r={props:{titles:{type:Array,default:function(){return[]}},tableColumnWidth:{type:Number,default:120},initGetList:{type:Boolean,default:!0},formOptions:{type:Object},fetchData:{type:Object,required:!0},columns:{type:Array,required:!0},params:{type:Object,default:function(){return{}}}},data:()=>({result:{},listLoading:!1,size:"small",tableData:[],total:0,currentPage:1,pageSize:10}),created(){this.initGetList&&this.initData()},methods:{changeDate(e,t){e||(e=["",""]),this.$set(this.params,t.prop[0],e[0]),this.$set(this.params,t.prop[1],e[1])},initData(){this.currentPage=1,this.getList()},getList(){let e={},t=this.fetchData.url;if(!t)return;let a=this.fetchData.method||"get";"get"===(a=a.toLowerCase())?(t+=`?size=${this.pageSize}&current=${this.currentPage}`,Object.keys(this.params).forEach(e=>{0!==e.indexOf("_")&&e&&this.params[e]&&(t+=`&${e}=${this.params[e]}`)})):"post"===a&&(e.data=this.fetchData.data),e.url=t,e.method=this.fetchData.method,this.listLoading=!0,this.$axios(e).then(e=>{this.listLoading=!1,"1000"===e.code?(this.tableData=e.data.content,this.result=e.data,this.total=e.data.total):this.$message.error(e.msg||"获取数据失败")}).catch(()=>{this.listLoading=!1,this.$message.error("获取数据失败")})},handleSizeChange(e){this.pageSize=e,this.getList()},handleCurrentChange(e){this.currentPage=e,this.getList()},formatJson(e,t){let a=this;return t.map(t=>e.map(e=>a.handleColumn(t,e)))},getSizeToList(e,t=2e3){return new Promise((a,n)=>{let r={},i=this.fetchData.url;if(!i)return;let o=this.fetchData.method||"get";"get"===(o=o.toLowerCase())?(i+=`?size=${t}&current=${e}`,Object.keys(this.params).forEach(e=>{0!==e.indexOf("_")&&e&&this.params[e]&&(i+=`&${e}=${this.params[e]}`)})):"post"===o&&(r.data=this.fetchData.data),r.url=i,r.method=this.fetchData.method,this.$axios(r).then(e=>{"1000"===e.code?a(e.data.content):n(new Error)}).catch(e=>{n(e)})})},exportExcel(){const e=this.$loading({lock:!0,text:"下载中..."});let t=this.$route.query.downSize,a=Math.ceil(this.total/t),n=[];for(var r=1;r<=a;r++)n.push(this.getSizeToList(r,t));Promise.all(n).then(e=>{let t=[];e.forEach(e=>{t=t.concat(e)})}).catch(()=>{e.close(),this.$message.error("下载表格失败")})},handleColumn:(e,t)=>(t.split(".").forEach(t=>{e=e[t]}),void 0!==e&&""!==e||(e="-"),e),indexMethod(e){return(this.currentPage-1)*this.pageSize+e+1}},filters:{handleColumn:(e,t)=>(t.split(".").forEach(t=>{e=e[t]}),void 0!==e&&""!==e||(e="-"),e)}};a(1);var i=function(e,t,a,n,r,i,o,s){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=a,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):r&&(l=s?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}(r,n,[],!1,null,"f2466236",null);i.options.__file="src/el-form-table/index.vue";var o=i.exports,s={install:function(e,t){e.component("form-table",o),t.axios&&(e.prototype.$axios=t.axios)}};t.default=s}]).default}));